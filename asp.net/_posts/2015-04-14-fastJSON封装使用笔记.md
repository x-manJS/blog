---
layout: post
title: fastJSON封装使用笔记
tags: json fastJSON
---

fastJSON很快，比json.net快。总之呢，序列化很快，这个百度谷歌搜都有对比图证明。

今天抽时间简单的封装了一下fastJSON（边界化第三方应用）。


用nuget安装了下fastJSON。然后简单的使用。

首先按照接fastJSON的接口进行如下封装：


    public class FastJsonSerializer
    {
        public static string GenerateJosn(object obj)
        {
            string json = fastJSON.JSON.ToJSON(obj);
            return json;
        }
    }

然后测试：

	[TestClass]
    public class JsonWoker_Test
    {
        [TestMethod]
        public void GenerateJosn_test()
        {
            TestObjectPerson person = MockData();

            string json = FastJsonSerializer.GenerateJosn(person);

            Assert.AreEqual(json.Length, 114);
        }

        private TestObjectPerson MockData()
        {
            TestObjectAddress address = MockAddress();
            TestObjectPerson person = MockPerson(address);

            return person;
        }

        private TestObjectAddress MockAddress()
        {
            TestObjectAddress address = new TestObjectAddress();
            address.Name = "厦门市洪山柄小区";
            address.PlaceCode = "361008";
            return address;
        }

        private TestObjectPerson MockPerson(TestObjectAddress address)
        {
            TestObjectPerson person = new TestObjectPerson();
            person.Name = "lzh";
            person.Age = 25;
            person.Address = address;

            return person;
        }


json的结果：

	{
		"$types":{
			"DLL.Basic.UnitTest.TestObjectPerson, DLL.Basic.UnitTest, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null":"1",
			"DLL.Basic.UnitTest.TestObjectAddress, DLL.Basic.UnitTest, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null":"2"
		},
		"$type":"1",
		"Name":"lzh",
		"Age":25,
		"Address":{
			"$type":"2",
			"Name":"\u53A6\u95E8\u5E02\u6D2A\u5C71\u67C4\u5C0F\u533A",
			"PlaceCode":"361008"
		}
	}

多了写不需呀的东西。查看接口。修改下封装：

    public class FastJsonSerializer
    {
        public static string GenerateJosn(object obj)
        {
            fastJSON.JSONParameters option = BuildJsonParameters();
            string json = fastJSON.JSON.ToJSON(obj, option);
            return json;
        }

        private static fastJSON.JSONParameters BuildJsonParameters()
        {
            fastJSON.JSONParameters option = new fastJSON.JSONParameters();
            option.UseExtensions = false; // 在序列化结果中不显示多余的实体信息
            return option;
        }
    }

这里使用了fastJSON.JSONParameters对象里的UseExtensions属性设置。来过滤掉了我们不需要的信息。

就暂时封装到这。